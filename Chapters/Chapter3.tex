% Chapter 3

\chapter{Conclusions and future work} % Main chapter title

\label{Chapter3}

This doctoral thesis has been focused on the study of the methodologies and applications of machine learning within the context of weather forecasting. Weather forecasting produces large amounts of data from both observations and numerical simulations. The interpretation of the information contained in these data sets presents interesting challenges in terms of the volume and its high dimensionality. The idea behind our work has been to explore the application of models that can learn to interpret and extract patterns out of these data. In particular, we have explored methodologies that use observed data to enhance the output of numerical simulated weather, and methods for deriving precipitation from basic weather fields. 

\subsection{Conclusions}

The first part of this doctoral thesis addresses the application of regression methods using circular variables. Most of the machine learning methodologies available for performing regression are designed to work with linear variables. Circular variables cannot be naturally represented by these algorithms and, in most cases, they are treated as linear variables, which often leads to unsatisfactory results. The first approach that we explored was the idea of using "cyclic kernels" to perform a non-parametric regression of wind speed. This method allows selecting observed data points around an specific directional component to perform a regression that improves wind speed forecasted by NWP. The second idea that we explored was a method for incorporating circular variables in regression trees. This method builds upon the already existing concept of circular trees proposing a new way of training the trees to improve their accuracy and computational performance.

\medskip

For our third contribution, we changed subject to explore the application of convolutional neural networks into a rain classification or detection problem. Using NWP data as input, treated as an image, we applied convolutional networks to interpret the spatial information contained in these fields and predict the existence of precipitation using observed data for specific collections. This work demonstrates that neural networks can be used to interpret the spatial structure and find correlations with other atmospheric processes, such as precipitation.  

\medskip

Our fourth and last contribution continues exploring the application of convolutional neural networks but with a more challenging task, inferring parameterised weather fields from basic variables. In this case, we explore the use of encoder-decoder networks to derive precipitation using atmospherical pressure fields at several heights. This work demonstrates how convolutional encoder-decoder networks, originally designed to perform segmentation tasks, can be modified to solve difficult problems in the field of weather forecasting, such as learning the physics that relates complex atmospherical processes with each other.

\bigskip
\bigskip
\bigskip

The main contributions in this doctoral thesis can be summarised as follows:

\begin{itemize}
  \item Non-parametric regression can significantly improve NWP fields by eliminating biases.
  \item Cyclic kernels enable non-parametric regression accounting for non resolved topographic effects.
  \item Circular regression trees with contiguous partitions significantly improve the accuracy of regression for circular variables compared to non-contiguous ones.
  \item Our proposed implementation of circular regression trees provides a significant improvement in computational performance and accuracy over the previous version.
  \item Convolutional neural networks (CNN) can extract the underlying spatial and temporal structure from basic NWP fields.
  \item A methodology to visualise the areas in a map that have higher influence in CNN models is proposed.
  \item Convolutional encoder-decoder networks have the capacity to learn the relationships between atmospheric variables. 
  \item This method can be used as an alternative to NWP parameterisations, being U-net the one that offers the best accuracy from all the compared networks.
\end{itemize}

\medskip

This doctoral work was set up and conceived as an exploratory work on the application of machine learning in the field of weather forecasting. In this context, one of the main challenges has been understanding and communicating concepts across both domains and communities. The machine learning community has grown out of the more generic computer science and statistics fields. The weather forecasting community, in spite of having strong ties to the numerical simulation and high performance aspects of computer science, it has been mainly driven along the physics field. For example, some concepts, such as stochastic modeling methods, have been developed in concurrently following different paths, which has resulted in the development of specific terminology to refer to often similar concepts.

\medskip

This challenge has become patent when presenting our ideas to journals belonging to both fields. Although NWP data sets provide an excellent resource for experimenting with generic machine learning algorithms, they require an understanding about the structure and significance of the different variables they represent. Communicating our ideas and contributions to the machine learning community, using a methodological approach, became difficult for the amount of context and domain-specific knowledge required to present our work.

\medskip

The experience has also been similar in the other direction, when presenting our work to weather forecasting audiences. Introducing new machine learning approaches and methodologies to the weather forecasting community has required us to dedicate an special effort in communicating and translating machine learning concepts in the domain-specific language. 

\medskip

Personally, the experience of working in this doctorate during these years, has led me to the appreciation of the amount of work required to make contributions in science and a much better understanding of the process. Although my level of understanding about the different machine learning methodologies and techniques has significantly improved through these years, the number of questions and unknowns in my head has only increased. Each of the papers that we published concludes presenting new interesting questions and challenges waiting to be explored.

\medskip

The outcomes of the research we have carried out, have also opened a window for optimism. Realising about the new perspective that machine learning brings to weather forecasting problems and the potential to improve our understanding about the atmosphere has been an encouraging experience. I personally hope to continue learning from and contributing to the development of new links between the machine learning and meteorological communities.

\subsection{Future Work}

The work carried out on the first two publications, on the use of circular variables into regression models, has not been explored in the case of ANN models. Exploring the possibilities that neural networks and deep learning models offer in the space of circular variables remains an interesting topic of research. Our literature research about previous works in this field, makes us think that is mostly an unexplored area in neural networks and this is something that I would like to explore.

\medskip

The software for generating circular trees, published in the Environmental Modelling & Software journal, provides a basic implementation of regression tree. Research on classification and regression trees has demonstrated that ensemble methods greatly outperform individual trees. Also, there are techniques such as pruning, balancing or smoothing \citep{breiman1984classification,quinlan1993}, that significantly improve the performance of trees. There are packages such as Python scikit-learn \citep{pedregosa2011scikit}, that offer a large collection of machine learning models and tools to facilitate the training and testing of these models. Offering our implementation of circular regression tree, as a module in one of these generic machine learning packages, would considerable contribute to the diffusion and expansion of this methodology. Another benefit would be that functionalities available for the generic binary tree class, such as ensemble methods, could then be applied to circular trees.

\medskip

In the area of deep learning, we have limited our study to the application of CNNs to NWP fields. We have demonstrated that this kind of networks are able to extract the spatial information contained in gridded weather fields. The temporal component of weather forecasting, which describes the evolution of the different atmospheric parameters, has not been explored. Recurrent Neural Networks (RNN) \citep{williams1989learning}, is a class of neural network where the output of the network is feed back as input to the next step, providing a model to simulate sequential data. The combination of CNNs and RNNs has been already proposed to forecast precipitation from radar data \citep{xingjian2015convolutional} but the representation of the temporal component of weather forecasting can be explored using other kind of networks. For example, temporal convolution \citep{bai2018empirical} has been recently proposed as an alternative to RNN methods demonstrating to perform better in different applications.

\medskip

Lastly, another idea that I would like to explore is the automatic generation of Terminal Aerodrome Forecast (TAF) messages. TAFs complement and use similar encoding to METAR reports but describe the evolution of the meteorological conditions at a specific airport. Nowadays they are produced by human forecasters based on the information provided by NWP and observations. The idea at the start of this thesis was to explore the possibility of creating such system. TAFs contain information relative to different variables, such as the wind, clouds, visibility conditions or pressure. Soon, at the beginning of this work, I realised that each of these variables contains enough complexities which need to be solved as independent pieces of research. The idea of implementing such system is still relevant and proposes a challenging and interesting piece of work that I would like to consider in the future.

